# üèÉ SOU ESPORTE V12.3 - API Fix

**Backup Completo do Aplicativo Sou Esporte**  
*Data: 26 de Janeiro de 2026*

---

## üìã Sobre Este Backup

Este √© um backup **100% completo e funcional** do aplicativo Sou Esporte, com corre√ß√£o cr√≠tica para rodar localmente.

### ‚úÖ Corre√ß√µes inclu√≠das nesta vers√£o (V12.3):

| Corre√ß√£o | Descri√ß√£o |
|----------|-----------|
| ‚úÖ **API Mobile-First** | Removida depend√™ncia de `client/index.html` |
| ‚úÖ **Erro ENOENT** | Corrigido erro 500 ao acessar raiz `/` |
| ‚úÖ **Rota Raiz** | Agora retorna JSON com status da API |
| ‚úÖ **Health Check** | Endpoint `/health` funcionando |
| ‚úÖ **tRPC** | Endpoints `/api/trpc/*` funcionando normalmente |

### Corre√ß√µes herdadas da V12.2:
- ‚úÖ Categoria de Atleta (PRO/AMATEUR/COACH) salvando corretamente
- ‚úÖ Modalidades esportivas funcionando
- ‚úÖ Integra√ß√£o Grid/Bio com backend

---

## üöÄ Instala√ß√£o R√°pida

### 1. Configurar Banco de Dados

```bash
# Criar banco e usu√°rio
sudo mysql -e "CREATE DATABASE IF NOT EXISTS souesporte CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;"
sudo mysql -e "CREATE USER IF NOT EXISTS 'souesporte'@'localhost' IDENTIFIED BY 'souesporte123';"
sudo mysql -e "GRANT ALL PRIVILEGES ON souesporte.* TO 'souesporte'@'localhost';"
sudo mysql -e "FLUSH PRIVILEGES;"

# Importar dados
mysql -u souesporte -psouesporte123 souesporte < database/souesporte_full_dump.sql
```

### 2. Iniciar API (Terminal 1)

```bash
cd api
npm install
npm run dev
```

**Verificar se est√° funcionando:**
```bash
curl http://localhost:3000/
# Deve retornar: {"status":"ok","message":"Sou Esporte API is running",...}
```

### 3. Iniciar Mobile (Terminal 2)

```bash
cd mobile
npm install
npx expo start --tunnel
```

---

## üìÅ Estrutura do Backup

```
V12.3-Sou-Esporte-API-Fix/
‚îú‚îÄ‚îÄ README.md                    # Esta documenta√ß√£o
‚îú‚îÄ‚îÄ CREDENCIAIS.md               # Todas as credenciais
‚îú‚îÄ‚îÄ RESTAURAR_COMPLETO.sh        # Script de restaura√ß√£o autom√°tica
‚îÇ
‚îú‚îÄ‚îÄ api/                         # Backend (Node.js + tRPC)
‚îÇ   ‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _core/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vite.ts          # ‚≠ê ARQUIVO CORRIGIDO
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routers.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db.ts
‚îÇ   ‚îú‚îÄ‚îÄ drizzle/
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ mobile/                      # Frontend (React Native + Expo)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îî‚îÄ‚îÄ database/
    ‚îî‚îÄ‚îÄ souesporte_full_dump.sql # Dump completo (41 tabelas)
```

---

## üîß O que foi corrigido no `vite.ts`

### Antes (V12.2 - com erro):
```typescript
// Tentava carregar client/index.html que n√£o existe
const clientTemplate = path.resolve(..., "client", "index.html");
let template = await fs.promises.readFile(clientTemplate, "utf-8");
// ‚ùå Error: ENOENT: no such file or directory
```

### Depois (V12.3 - corrigido):
```typescript
// API pura, sem depend√™ncia de frontend web
app.get("/", (_req, res) => {
  res.status(200).json({
    status: "ok",
    message: "Sou Esporte API is running",
    version: "12.3",
    endpoints: { health: "/health", trpc: "/api/trpc/*" }
  });
});
// ‚úÖ Funciona perfeitamente
```

---

## üîë Credenciais

### Banco de Dados
```
Host:     localhost
Database: souesporte
User:     souesporte
Password: souesporte123
```

### JWT
```
Secret: sou-esporte-jwt-secret-v12-2026
```

### Usu√°rio de Teste
```
Email: miltongustavo@hotmail.com
Login: Via OTP (c√≥digo aparece no console da API)
```

---

## üõ†Ô∏è Troubleshooting

### Erro: "Connection refused" ao conectar no MySQL

```bash
# macOS com Homebrew
brew services start mariadb

# Linux
sudo systemctl start mariadb
```

### Erro: "Access denied" no MySQL

```bash
# Recriar usu√°rio
sudo mysql -e "DROP USER IF EXISTS 'souesporte'@'localhost';"
sudo mysql -e "CREATE USER 'souesporte'@'localhost' IDENTIFIED BY 'souesporte123';"
sudo mysql -e "GRANT ALL PRIVILEGES ON souesporte.* TO 'souesporte'@'localhost';"
sudo mysql -e "FLUSH PRIVILEGES;"
```

### API retorna erro 500

```bash
# Verificar se est√° usando V12.3
curl http://localhost:3000/
# Deve retornar JSON, n√£o erro 500
```

### OTP n√£o chega

```bash
# Em desenvolvimento, o c√≥digo OTP aparece no console da API
# Procure por: "OTP Code: XXXXXX"
```

---

## üìû Informa√ß√µes Adicionais

### Vers√£o
- **Vers√£o**: 12.3 "API Fix"
- **Data**: 26 de Janeiro de 2026
- **Status**: ‚úÖ Completo e Funcional

### Changelog V12.3
- Removida depend√™ncia de `client/index.html` no `vite.ts`
- API agora funciona como backend puro (mobile-first)
- Rota raiz `/` retorna JSON com status
- Endpoint `/health` funcionando
- Todos os endpoints tRPC funcionando normalmente

---

**Desenvolvido com ‚ù§Ô∏è para a comunidade esportiva brasileira**
